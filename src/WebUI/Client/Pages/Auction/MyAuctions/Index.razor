@page "/auctions"
@attribute [Authorize(Permissions.Auction)]

<PageTitle>My Auctions</PageTitle>

<h3>Auctions you started</h3>
<br />
 
@if (CreatedAuctions != null && CreatedAuctions.Auctions.Count > 0)
{
    <a href="@($"auctions/new")" class="btn btn-success table-btn" data-toggle="tooltip" data-placement="bottom" title="Add">
	    <i class="oi oi-book"></i> Add new
    </a>
    <table class="table table-striped table-hover w-75">
        <thead>
            <tr>
                <th>Title</th>
                <th>Opening time</th>
                <th>Closing time</th>
                <th>Current Bid</th>	
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in CreatedAuctions.Auctions)
            {
                <tr>
                    <td><a href="@($"auctions/{item.Id.ToString()}/view")" data-toggle="tooltip" data-placement="bottom">@item.Title</a></td>
                    <td>@item.StartDate.ToString("dd/MM/yyyy HH:mm")</td>
                    <td>@item.EndDate.ToString("dd/MM/yyyy HH:mm")</td>
                    <td style="text-align: center;">
                        @if (@item.CurrentBidAmount == 0)
                        {
                            <i>-</i>
                        }
                        else
                        {
                            @item.CurrentBidAmount.ToString()
                        }
                    </td>
                    <td>
                        @if (DateTime.Now < item.StartDate && item.WinningBidder == null)
                        {
                            <a href="@($"auctions/{item.Id.ToString()}")" class="btn btn-primary table-btn" data-toggle="tooltip" data-placement="bottom" title="Edit">
                                Edit
                            </a>
                            <a href="@($"auctions")" class="btn btn-danger table-btn" @onclick="@(() => DeleteItem(item))" data-toggle="tooltip" data-placement="bottom" title="Delete">
                                Delete
                            </a>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <h5 class="text-center">You haven't created any auctions yet. Why not <a href="@($"auctions/new")">create one</a> now?</h5>
}

<br/>
<hr />
<br />

<h3>Auctions you won</h3>
<br />

@if(WonAuctions != null && WonAuctions.Auctions.Count > 0)
{
    <div class="row">
        @foreach (var item in WonAuctions.Auctions)
        {
            <div class="col-sm-3">
                <div class="card">
                    <img class="card-img-top" src="https://riaccdn.s3.us-east-2.amazonaws.com/dev_cdn/front-page-slider/Greg_Lampe_Web_Image_w1600.jpg" alt="Card image">
                    <div class="card-body">
                        <h4 class="card-title text-center">@item.Title</h4>
                        <hr />
                        <p class="card-text">
                            <span class="oi oi-tag" aria-hidden="true"></span>
                            Category: @item.Category
                        </p>
                        <p class="card-text">
                            <span class="oi oi-align-left" aria-hidden="true"></span>
                            Description: @item.Description
                        </p>
                        <p class="card-text">
                            <span class="oi oi-dollar" aria-hidden="true"></span>
                            Price: @(item.BuyItNowPrice)
                        </p>
                        <hr />
                        <div class="d-flex justify-content-center">
                            <a href="@($"auctions/{item.Id.ToString()}/view")" data-toggle="tooltip" data-placement="bottom" class="btn btn-dark">Show</a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <h5 class="text-center">You haven't won any auction items yet. Keep browsing our <a href="/listings">auctions</a> to find something you like!</h5>
}


<ConfirmationDialog Title="Confirm delete"
					CloseEventCallback="@OnConfirmationDeleteDialogClosed"
					@ref="@ConfirmationDeleteDialog"></ConfirmationDialog>